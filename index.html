<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Nothing</title>
  <meta name="theme-color" content="#000000" />
  <style>
    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      color: rgba(255,255,255,.75);
      font-family: -apple-system, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      overflow: hidden;
    }

    /* Big scrollable black canvas */
    .scroll {
      height: 100vh;
      overflow-y: scroll;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: none;
      scrollbar-width: none;
    }
    .scroll::-webkit-scrollbar { display: none; }

    .canvas {
      height: 300vh; /* lets user scroll a lot, but nothing changes */
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 28px;
      box-sizing: border-box;
    }

    /* Message overlay */
    .msg {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 28px;
      box-sizing: border-box;
      pointer-events: none;
      opacity: 0;
      transition: opacity 650ms ease;
    }
    .msg.show { opacity: 1; }

    .msgText {
      font-size: 20px;
      line-height: 1.4;
      color: rgba(255,255,255,.7);
      max-width: 560px;
    }

    /* Tiny helper text (only shown if wake lock fails) */
    .tiny {
      position: fixed;
      left: 0; right: 0;
      bottom: 18px;
      text-align: center;
      font-size: 12px;
      color: rgba(255,255,255,.35);
      opacity: 0;
      transition: opacity 300ms ease;
      pointer-events: none;
    }
    .tiny.show { opacity: 1; }
  </style>
</head>
<body>
  <div class="scroll" id="scroll">
    <div class="canvas"></div>
  </div>

  <div class="msg" id="msg">
    <div class="msgText" id="msgText"></div>
  </div>

  <div class="tiny" id="tiny">Tip: set Auto-Lock to “Never” for long sessions.</div>

  <script>
    // ---- Messages (LOCKED 1A) ----
    const schedule = [
       { min: 0, text: "Test: message system works." },
    ];

    // ---- Invisible timer starts immediately ----
    const start = Date.now();
    const shown = new Set();

    const msg = document.getElementById("msg");
    const msgText = document.getElementById("msgText");
    const tiny = document.getElementById("tiny");

    function vibrateSoft() {
      // Works on many Android devices; iPhone Safari often ignores vibration.
      if (navigator.vibrate) navigator.vibrate(20);
    }

    async function requestWakeLock() {
      // Works best on Chrome/Android; iOS Safari support is limited.
      try {
        if ("wakeLock" in navigator) {
          await navigator.wakeLock.request("screen");
          // If it works, don't show tip.
          tiny.classList.remove("show");
        } else {
          tiny.classList.add("show");
        }
      } catch {
        tiny.classList.add("show");
      }
    }

    function showMessage(text) {
      vibrateSoft();
      msgText.textContent = text;
      msg.classList.add("show");

      setTimeout(() => msg.classList.remove("show"), 3200);
    }

    // Check every second; only trigger exactly on minute boundaries.
    setInterval(() => {
      const elapsedMs = Date.now() - start;
      const elapsedSec = Math.floor(elapsedMs / 1000);
      const elapsedMin = Math.floor(elapsedSec / 60);

      // Only check at the exact first second of each minute:
      if (elapsedSec % 60 !== 0) return;

      for (const item of schedule) {
        if (elapsedMin === item.min && !shown.has(item.min)) {
          shown.add(item.min);
          showMessage(item.text);
        }
      }
    }, 1000);

    // “Room breath” haptic every 6 minutes (soft)
    setInterval(() => vibrateSoft(), 6 * 60 * 1000);

    // --- TEST: show a message after 3 seconds (guaranteed) ---
setTimeout(() => {
  showMessage("TEST: if you see this, messages work.");
}, 3000);

    // Ask for wake lock after first user interaction (required by browsers)
    document.addEventListener("click", requestWakeLock, { once: true });
    document.addEventListener("touchstart", requestWakeLock, { once: true });
  </script>
</body>
</html>
